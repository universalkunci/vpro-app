<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>V-PRO MAX - Dashboard</title>
    <style>
        :root { --slate-800: #1e293b; --primary: #4f46e5; }
        body { background: #f1f5f9; font-family: sans-serif; margin: 0; }
        .nav { background: var(--slate-800); padding: 1rem 2rem; display: flex; justify-content: space-between; color: white; align-items: center; }
        .nav a { color: #94a3b8; text-decoration: none; margin-left: 1rem; font-weight: bold; }
        .container { max-width: 1200px; margin: 2rem auto; padding: 0 20px; }
        .stats-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 20px; }
        .stat-card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); border-top: 4px solid var(--primary); }
        .stat-card h3 { color: #64748b; margin: 0; font-size: 14px; }
        .stat-card .value { font-size: 24px; font-weight: bold; margin-top: 10px; }
    </style>
</head>
<body>
    <nav class="nav">
        <strong>UNIVERSAL GROUP V-PRO MAX</strong>
        <div>
            <a href="index.html" style="color:white">Dashboard</a>
            <a href="produk.html">Produk</a>
            <a href="pembelian.html">Pembelian</a>
            <a href="penjualan.html">Penjualan</a>
        </div>
    </nav>
    <div class="container">
        <div class="stats-grid">
            <div class="stat-card"><h3>TOTAL OMZET</h3><div class="value" id="tSales">Rp 0</div></div>
            <div class="stat-card" style="border-top-color:#10b981"><h3>ESTIMASI PROFIT</h3><div class="value" id="tProfit" style="color:#10b981">Rp 0</div></div>
            <div class="stat-card" style="border-top-color:#f59e0b"><h3>TOTAL PESANAN</h3><div class="value" id="tOrders">0</div></div>
        </div>
        <div style="background:white; padding:20px; border-radius:10px;">
            <h3>Riwayat Penjualan Terakhir</h3>
            <table style="width:100%; border-collapse:collapse" id="salesTable">
                <thead><tr style="text-align:left; border-bottom:1px solid #eee"><th>Bulan</th><th>Marketplace</th><th>Toko</th><th>Profit</th></tr></thead>
                <tbody id="sBody"></tbody>
            </table>
        </div>
    </div>
    <script type="module">
        import { CloudDB } from './core-db.js';
        const formatIDR = (n) => "Rp " + (n||0).toLocaleString('id-ID');
        async function load() {
            const data = await CloudDB.getAll("sales_history");
            let s=0, p=0, o=0;
            document.getElementById('sBody').innerHTML = data.map(i => {
                s += i.sales; p += i.profit; o += i.orders;
                return `<tr><td>${i.month}</td><td>${i.mplace}</td><td>${i.store}</td><td>${formatIDR(i.profit)}</td></tr>`;
            }).join('');
            document.getElementById('tSales').innerText = formatIDR(s);
            document.getElementById('tProfit').innerText = formatIDR(p);
            document.getElementById('tOrders').innerText = o;
        }
        load();
    </script>
</body>
</html>